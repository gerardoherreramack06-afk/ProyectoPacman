<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emulador Treviño - PacMan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: black;
            height: 100vh;
            color: white;
            overflow: hidden;
            flex-direction: column;
        }
        canvas {
            border: 5px solid #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.7);
        }
        .controls {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        .button {
            background-color: #444;
            color: white;
            border: none;
            padding: 10px;
            margin: 5px;
            font-size: 18px;
            cursor: pointer;
        }
        .button:active {
            background-color: #666;
        }
    </style>
</head>
<body>
    <canvas id="pacmanCanvas" width="560" height="560"></canvas>
    <div class="controls">
        <button class="button" id="left">←</button>
        <button class="button" id="up">↑</button>
        <button class="button" id="right">→</button>
        <button class="button" id="down">↓</button>
    </div>
    <script>
        const canvas = document.getElementById('pacmanCanvas');
        const ctx = canvas.getContext('2d');

        const cellSize = 20;
        const rows = 28;
        const cols = 28;
        const pacManSpeed = 5;

        let pacMan = { x: 14 * cellSize, y: 14 * cellSize, direction: 'right', nextDirection: 'right' };
        let ghosts = [
            { x: 12 * cellSize, y: 12 * cellSize, direction: 'left' },
            { x: 15 * cellSize, y: 15 * cellSize, direction: 'down' }
        ];
        let dots = [];
        let score = 0;
        let gameOver = false;

        // Crear el laberinto de Pac-Man (simplificado)
        function createMaze() {
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    if ((row === 0 || row === rows - 1 || col === 0 || col === cols - 1) || 
                        (row % 2 === 0 && col % 2 === 0)) {
                        ctx.fillStyle = 'green';  // Cambio de azul a verde
                        ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
                    } else {
                        dots.push({ x: col * cellSize + cellSize / 2, y: row * cellSize + cellSize / 2 });
                    }
                }
            }
        }

        // Dibujar Pac-Man
        function drawPacMan() {
            ctx.beginPath();
            ctx.arc(pacMan.x + cellSize / 2, pacMan.y + cellSize / 2, cellSize / 2, 0.2 * Math.PI, 1.8 * Math.PI);
            ctx.lineTo(pacMan.x + cellSize / 2, pacMan.y + cellSize / 2);
            ctx.fillStyle = 'yellow';
            ctx.fill();
            ctx.closePath();
        }

        // Dibujar los puntos
        function drawDots() {
            ctx.fillStyle = 'white';
            dots.forEach(dot => ctx.beginPath() && ctx.arc(dot.x, dot.y, 3, 0, 2 * Math.PI) && ctx.fill());
        }

        // Movimiento de Pac-Man
        function movePacMan() {
            if (pacMan.direction === 'left') pacMan.x -= pacManSpeed;
            if (pacMan.direction === 'right') pacMan.x += pacManSpeed;
            if (pacMan.direction === 'up') pacMan.y -= pacManSpeed;
            if (pacMan.direction === 'down') pacMan.y += pacManSpeed;

            if (pacMan.x < 0) pacMan.x = canvas.width - cellSize;
            if (pacMan.x >= canvas.width) pacMan.x = 0;
            if (pacMan.y < 0) pacMan.y = canvas.height - cellSize;
            if (pacMan.y >= canvas.height) pacMan.y = 0;
        }

        // Detectar colisión con puntos
        function detectCollisions() {
            dots.forEach((dot, index) => {
                if (Math.abs(pacMan.x + cellSize / 2 - dot.x) < cellSize / 2 &&
                    Math.abs(pacMan.y + cellSize / 2 - dot.y) < cellSize / 2) {
                    dots.splice(index, 1);
                    score += 10;
                }
            });
        }

        // Dibuja los fantasmas
        function drawGhosts() {
            ghosts.forEach(ghost => {
                ctx.beginPath();
                ctx.arc(ghost.x + cellSize / 2, ghost.y + cellSize / 2, cellSize / 2, 0, 2 * Math.PI);
                ctx.fillStyle = 'red';
                ctx.fill();
                ctx.closePath();
            });
        }

        // Movimiento de fantasmas
        function moveGhosts() {
            ghosts.forEach(ghost => {
                if (ghost.direction === 'left') ghost.x -= pacManSpeed;
                if (ghost.direction === 'right') ghost.x += pacManSpeed;
                if (ghost.direction === 'up') ghost.y -= pacManSpeed;
                if (ghost.direction === 'down') ghost.y += pacManSpeed;

                if (ghost.x < 0) ghost.x = canvas.width - cellSize;
                if (ghost.x >= canvas.width) ghost.x = 0;
                if (ghost.y < 0) ghost.y = canvas.height - cellSize;
                if (ghost.y >= canvas.height) ghost.y = 0;
            });
        }

        // Actualizar el juego
        function update() {
            if (gameOver) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            createMaze();
            drawDots();
            movePacMan();
            detectCollisions();
            drawPacMan();
            drawGhosts();
            moveGhosts();

            if (dots.length === 0) {
                alert("¡Ganaste!");
                gameOver = true;
            }

            requestAnimationFrame(update);
        }

        // Control de Pac-Man con las teclas
        window.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowLeft' && pacMan.nextDirection !== 'right') pacMan.nextDirection = 'left';
            if (e.key === 'ArrowRight' && pacMan.nextDirection !== 'left') pacMan.nextDirection = 'right';
            if (e.key === 'ArrowUp' && pacMan.nextDirection !== 'down') pacMan.nextDirection = 'up';
            if (e.key === 'ArrowDown' && pacMan.nextDirection !== 'up') pacMan.nextDirection = 'down';
        });

        // Botones de control para dispositivos móviles
        document.getElementById('left').addEventListener('click', () => {
            if (pacMan.nextDirection !== 'right') pacMan.nextDirection = 'left';
        });
        document.getElementById('right').addEventListener('click', () => {
            if (pacMan.nextDirection !== 'left') pacMan.nextDirection = 'right';
        });
        document.getElementById('up').addEventListener('click', () => {
            if (pacMan.nextDirection !== 'down') pacMan.nextDirection = 'up';
        });
        document.getElementById('down').addEventListener('click', () => {
            if (pacMan.nextDirection !== 'up') pacMan.nextDirection = 'down';
        });

        setInterval(() => pacMan.direction = pacMan.nextDirection, 100);

        update();
    </script>
</body>
</html>


